''' An implementation of Peter Stetson's variability index; see
'On the Automatic Determination of Light-Curve Parameters for Cepheid
Variables', Stetson 1996, PASP.

'''

import numpy as np

def I(b, sigma_b, v, sigma_v):
    '''The Welch/Stetson variability index I.
    Calculates variability index given two magnitude bands and uncertainties.

    Inputs: two arrays of magnitudes and two arrays of associated sigmas.
    Returns a number.
    '''

    if not (b.size == sigma_b.size == v.size == sigma_v.size):
        raise Exception(Array dimensions mismatch)
        return

    n = b.size

    s = np.sum( (b - b.mean())/sigma_b * (v - v.mean())/sigma_v )

    I = np.sqrt(1. / (n*(n-1))) * s

    return I

'''   
def J: # Much more complicated, I fear...
    pass
'''
